<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>‚òï Java Everywhere: Using Java in iOS Projects | AppDelegate</title>
<meta name=keywords content><meta name=description content="Ever wondered if you could use Java in your iOS app?"><meta name=author content="Tarlan"><link rel=canonical href=http://localhost:1313/posts/java-on-ios/java-on-ios/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.17bb5aea7d60b17b0549f345606edfe2e75165ff59033d250af6c8c89afaa3ea.css integrity="sha256-F7ta6n1gsXsFSfNFYG7f4udRZf9ZAz0lCvbIyJr6o+o=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/java-on-ios/java-on-ios/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="‚òï Java Everywhere: Using Java in iOS Projects"><meta property="og:description" content="Ever wondered if you could use Java in your iOS app?"><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/posts/java-on-ios/java-on-ios/"><meta property="og:image" content="http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-05-10T00:00:00+00:00"><meta property="article:modified_time" content="2024-05-10T00:00:00+00:00"><meta property="og:site_name" content="AppDelegate"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="‚òï Java Everywhere: Using Java in iOS Projects"><meta name=twitter:description content="Ever wondered if you could use Java in your iOS app?"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"‚òï Java Everywhere: Using Java in iOS Projects","item":"http://localhost:1313/posts/java-on-ios/java-on-ios/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"‚òï Java Everywhere: Using Java in iOS Projects","name":"‚òï Java Everywhere: Using Java in iOS Projects","description":"Ever wondered if you could use Java in your iOS app?","keywords":[],"articleBody":" The Backstory Recently, I encountered a challenge while working on an iOS project that required a specific functionality that proved to be highly complex to implement. My search led me to a Java library that had the exact features I needed. However, there was one major roadblock: it was only available in Java. At first, I tried to find a native alternative that could be easily integrated into my iOS project via SPM, CocoaPods, or other dependency managers. Unfortunately, none of the available options matched the functionality of the Java library. As I explored methods for integrating Java into iOS, I found that many existing solutions were not up-to-date, lacked sufficient documentation, and had limited support, which made them less effective for my needs. Just when I was about to give up, I stumbled upon MobiVM (formerly known as RoboVM).\nWhat is MobiVM? MobiVM is a fork of the last open-source release of RoboVM, a project discontinued after being acquired by Microsoft. It is basically an AOT (ahead-of-time) compiler for Java bytecode, targeting iOS, macOS, and Linux. This implies that no interpretation is ever done and the code is run natively on the target CPU. MobiVM also provides bindings for iOS-specific APIs, enabling developers to access native iOS features directly from Java.\nWith MobiVM, you can create a Java project and convert it into an .xcframework, supporting various architectures, such as arm64 and x86_64. You can use this framework in your Swift and Objective-C projects.\nSetting up your environment Before diving into coding your Java framework, you should complete the following steps:\nInstall an IDE supporting Java (IntelliJ IDEA, Android Studio, Eclipse) Install the MobiVM plugin You can download it from here if you‚Äôre using IntelliJ For other IDEs, please follow this guide by MobiVM ‚ÄúHello from Java!‚Äù Now that the environment is set up, let‚Äôs start exploring MobiVM through a straightforward demo project. This project consists of a single Java class (DemoClass) with a small function that returns ‚ÄúHello from Java!‚Äù.\nThe first step is to create a new MobiVM project. The plugin makes this process pretty straightforward. You need to open the new project dialog in your IDE and select RoboVM ‚Üí RoboVM iOS Framework. I‚Äôve already done it for you and it can be accessed here.\nIf you‚Äôd like to create the project on your own, check out this guide. By default, the created project contains some code which I‚Äôve removed to keep it as simple as possible. As you can see, the DemoClass is annotated with the @CustomClass annotation and contains a hello() method, annotated with the @Method annotation.\n@CustomClass(\"DemoClass\") public class DemoClass extends NSObject { @Method(selector = \"hello\") public static String hello() { return \"Hello from Java!\"; } } The annotations help MobiVM wire things up in the background. Without them, your Java classes and methods won‚Äôt be accessible from Swift.\nIn addition to the annotations, we need an Objective-C header file (headers/MyFramework.h) containing the interface for the DemoClass:\n#import @interface DemoClass: NSObject +(NSString*)hello; @end The header must accurately represent the function‚Äôs signature. Otherwise, it won‚Äôt behave as expected when called. Since the hello() function returns a String, we use the corresponding NSString* return type in our header.\nIn addition, the header must be exposed via the modulemap located at modules/module.modulemap as follows:\nframework module MyFramework { umbrella header \"MyFramework.h\" export * module * { export * } } In order to create an xcframework from your code, run the following terminal command in the project directory:\nmvn -Drobovm.enableBitcode=true compile robovm:install This command will generate an xcframework file under target/robovm. In order to test the code, you should drag and drop this file into your iOS project. Once added to the project, the framework can be imported and used as follows. You can also find a demo iOS app here.\nimport SwiftUI import MyFramework // \u003c- Importing the Java framework struct ContentView: View { @State private var someText = \"\" var body: some View { VStack(spacing: 20) { Image(systemName: \"cup.and.saucer.fill\") .imageScale(.large) .foregroundStyle(.tint) Text(someText) } .padding() .onAppear { // Calling the Java method someText = DemoClass.hello() ?? someText } } } As you can see below, the function call succeeded üéâ: If you‚Äôd like to specify the architectures that the framework should be built for, modify the robovm.xml file:\nios arm64 arm64-simulator x86_64 xcframework ... Issues Getting MobiVM to work with my Java code wasn‚Äôt very straightforward as I encountered some challenges mentioned below.\nEXC_BAD_ACCESS Adding a dependency to the Java project may sometimes lead to an EXC_BAD_ACCESS crash in your app. If this happens, you‚Äôll have to add the missing package (or class) names under the tag of your robovm.xml file. Here‚Äôs an example:\ncom.mycompany.myframework.** com.example.dependency.** ‚ö†Ô∏è Force linking too many classes is not a good idea as it increases the size of your framework. As an optimization, you can replace the wildcard patterns with more specific ones, linking only the classes your code depends on.\nDuplicate symbol ‚ÄòOBJC_CLASS$_NSUserActivity' When I attempted to build my project for the arm64-simulator architecture, the build failed with the following error:\n[ERROR] ld: building exports trie: duplicate symbol '_OBJC_CLASS_$_NSUserActivity' [ERROR] clang: error: linker command failed with exit code 1 (use -v to see invocation) Updating Xcode to the latest version solved the problem.\nJava 8-related NoClassDefFoundError At the time of writing this post, MobiVM is compatible with Java 7. If your code or dependencies require Java 8 or above, you‚Äôll get a NoClassDefFoundError when you call your Java methods. To resolve this issue, consider using an experimental build of MobiVM.\nThings to Keep in Mind While MobiVM is incredibly helpful in situations where coding in Java is unavoidable, it also comes with certain drawbacks. It is definitely a good idea to look for native Swift solutions before considering this approach.\nDevelopment Process The development process gets complicated since now you have to maintain two separate codebases. The typical development process involves updating the Java code, converting it into an xcframework, moving the framework into an iOS project and testing the changes.\nDebugging Even if you do your best to handle Java exceptions properly in your project, some unchecked exceptions might slip through. When this happens, the app crashes, and it‚Äôs not always easy to determine the cause via Xcode. This difficulty extends to the debugging process in general. Although the Xcode debugger allows placing breakpoints and observing code execution step-by-step, this only works until you call a Java method. I often found myself adding ugly System.out.println statements in my Java code for debugging.\nLack of resources While investigating ways to execute Java on iOS, I realized that this is a niche need among developers, which is why there are few alternatives to MobiVM available right now. Not being an expert in MobiVM, I consistently rely on the GitHub community for support whenever I‚Äôm stuck. MobiVM has an awesome discussions page where you can quickly get your questions answered. Besides that, support options are limited, with Stack Overflow and ChatGPT providing minimal help.\nConclusion Despite the challenges, MobiVM made it possible to incorporate an important feature that brought high business value to the iOS project I was working on. This post is my way of paying it forward, hoping it proves beneficial to you as well.\nCheers! ‚ú®\n","wordCount":"1261","inLanguage":"en","image":"http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2024-05-10T00:00:00Z","dateModified":"2024-05-10T00:00:00Z","author":{"@type":"Person","name":"Tarlan"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/java-on-ios/java-on-ios/"},"publisher":{"@type":"Organization","name":"AppDelegate","logo":{"@type":"ImageObject","url":"http://localhost:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="AppDelegate (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>AppDelegate</a><div class=logo-switches></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;¬ª&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">‚òï Java Everywhere: Using Java in iOS Projects</h1><div class=post-description>Ever wondered if you could use Java in your iOS app?</div><div class=post-meta><span title='2024-05-10 00:00:00 +0000 UTC'>May 10, 2024</span>&nbsp;¬∑&nbsp;6 min&nbsp;¬∑&nbsp;Tarlan&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/java-on-ios/java-on-ios.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><ul><li><a href=#the-backstory>The Backstory</a></li><li><a href=#what-is-mobivm>What is MobiVM?</a></li><li><a href=#setting-up-your-environment>Setting up your environment</a></li><li><a href=#hello-from-java>‚ÄúHello from Java!‚Äù</a></li><li><a href=#issues>Issues</a></li><li><a href=#things-to-keep-in-mind>Things to Keep in Mind</a></li><li><a href=#conclusion>Conclusion</a></li></ul></li></ul></nav></div></details></div><div class=post-content><img src=../images/mobivm-article.png#center width=35%><h2 id=the-backstory>The Backstory<a hidden class=anchor aria-hidden=true href=#the-backstory>#</a></h2><p>Recently, I encountered a challenge while working on an iOS project that required a specific functionality that proved to be highly complex to implement. My search led me to a Java library that had the exact features I needed. However, there was one major roadblock: it was only available in Java. At first, I tried to find a native alternative that could be easily integrated into my iOS project via SPM, CocoaPods, or other dependency managers. Unfortunately, none of the available options matched the functionality of the Java library. As I explored methods for integrating Java into iOS, I found that many existing solutions were not up-to-date, lacked sufficient documentation, and had limited support, which made them less effective for my needs. Just when I was about to give up, I stumbled upon MobiVM (formerly known as RoboVM).</p><h2 id=what-is-mobivm>What is MobiVM?<a hidden class=anchor aria-hidden=true href=#what-is-mobivm>#</a></h2><p>MobiVM is a fork of the last open-source release of RoboVM, a project discontinued after being acquired by Microsoft. It is basically an AOT (ahead-of-time) compiler for Java bytecode, targeting iOS, macOS, and Linux. This implies that no interpretation is ever done and the code is run natively on the target CPU. MobiVM also provides bindings for iOS-specific APIs, enabling developers to access native iOS features directly from Java.</p><p>With MobiVM, <strong>you can create a Java project and convert it into an .xcframework</strong>, supporting various architectures, such as arm64 and x86_64. You can use this framework in your Swift and Objective-C projects.</p><h2 id=setting-up-your-environment>Setting up your environment<a hidden class=anchor aria-hidden=true href=#setting-up-your-environment>#</a></h2><p>Before diving into coding your Java framework, you should complete the following steps:</p><ol><li>Install an IDE supporting Java (IntelliJ IDEA, Android Studio, Eclipse)</li><li>Install the MobiVM plugin<ul><li>You can download it from <a href=https://plugins.jetbrains.com/plugin/14440-mobivm>here</a> if you‚Äôre using IntelliJ</li><li>For other IDEs, please follow this <a href=https://mobivm.github.io/dev/>guide</a> by MobiVM</li></ul></li></ol><h2 id=hello-from-java>‚ÄúHello from Java!‚Äù<a hidden class=anchor aria-hidden=true href=#hello-from-java>#</a></h2><p>Now that the environment is set up, let&rsquo;s start exploring MobiVM through a straightforward demo project. This project consists of a single Java class (DemoClass) with a small function that returns ‚ÄúHello from Java!‚Äù.</p><p>The first step is to create a new MobiVM project. The plugin makes this process pretty straightforward. You need to open the new project dialog in your IDE and select RoboVM ‚Üí RoboVM iOS Framework. I‚Äôve already done it for you and it can be accessed <a href=https://github.com/terlan98/mobivm-demo>here</a>.</p><ul><li>If you‚Äôd like to create the project on your own, check out <a href=https://dkimitsa.github.io/2018/01/16/tutorial-writing-framework-improved/#creating-framework-step-by-step>this</a> guide. By default, the created project contains some code which I‚Äôve removed to keep it as simple as possible.</li></ul><p>As you can see, the <code>DemoClass</code> is annotated with the <code>@CustomClass</code> annotation and contains a <code>hello()</code> method, annotated with the <code>@Method</code> annotation.</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>@CustomClass(<span style=color:#fc6a5d>&#34;DemoClass&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#fc5fa3>public</span> <span style=color:#fc5fa3>class</span> <span style=color:#5dd8ff>DemoClass</span> <span style=color:#fc5fa3>extends</span> NSObject {
</span></span><span style=display:flex><span>  @Method(selector = <span style=color:#fc6a5d>&#34;hello&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#fc5fa3>public</span> <span style=color:#fc5fa3>static</span> String <span style=color:#41a1c0>hello</span>() {
</span></span><span style=display:flex><span>    <span style=color:#fc5fa3>return</span> <span style=color:#fc6a5d>&#34;Hello from Java!&#34;</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The annotations help MobiVM wire things up in the background. Without them, your Java classes and methods won‚Äôt be accessible from Swift.</p><p>In addition to the annotations, we need an Objective-C header file (<code>headers/MyFramework.h</code>) containing the interface for the <code>DemoClass</code>:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objectivec data-lang=objectivec><span style=display:flex><span><span style=color:#fd8f3f>#import &lt;Foundation/Foundation.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#fd8f3f></span>
</span></span><span style=display:flex><span><span style=color:#fc5fa3>@interface</span> <span style=color:#5dd8ff>DemoClass</span>: <span style=color:#5dd8ff>NSObject</span>
</span></span><span style=display:flex><span>+(NSString*)<span style=color:#41a1c0>hello</span>;
</span></span><span style=display:flex><span><span style=color:#fc5fa3>@end</span>
</span></span></code></pre></div><p>The header must accurately represent the function‚Äôs signature. Otherwise, it won‚Äôt behave as expected when called. Since the <code>hello()</code> function returns a <code>String</code>, we use the corresponding <code>NSString*</code> return type in our header.</p><p>In addition, the header must be exposed via the modulemap located at <code>modules/module.modulemap</code> as follows:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objectivec data-lang=objectivec><span style=display:flex><span>framework module MyFramework {
</span></span><span style=display:flex><span>  umbrella header <span style=color:#fc6a5d>&#34;MyFramework.h&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  export *
</span></span><span style=display:flex><span>  module * { export * }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>In order to create an <code>xcframework</code> from your code, run the following terminal command in the project directory:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mvn -Drobovm.enableBitcode=<span style=color:#d0a8ff>true</span> compile robovm:install
</span></span></code></pre></div><br><p>This command will generate an xcframework file under <code>target/robovm</code>. In order to test the code, you should drag and drop this file into your iOS project.
<img src=../images/xcode-filetree.png width=30%></p><p>Once added to the project, the framework can be imported and used as follows. You can also find a demo iOS app <a href=https://github.com/terlan98/mobivm-demo>here</a>.</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#fc5fa3>import</span> <span style=color:#5dd8ff>SwiftUI</span>
</span></span><span style=display:flex;background-color:#353539><span><span style=color:#fc5fa3>import</span> <span style=color:#5dd8ff>MyFramework</span> <span style=color:#6c7986>// &lt;- Importing the Java framework</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fc5fa3>struct</span> <span style=color:#5dd8ff>ContentView</span>: View {
</span></span><span style=display:flex><span>    @State <span style=color:#fc5fa3>private</span> <span style=color:#fc5fa3>var</span> <span style=color:#41a1c0>someText</span> = <span style=color:#fc6a5d>&#34;&#34;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#fc5fa3>var</span> <span style=color:#41a1c0>body</span>: some View {
</span></span><span style=display:flex><span>        VStack(spacing: <span style=color:#d0bf69>20</span>) {
</span></span><span style=display:flex><span>            Image(systemName: <span style=color:#fc6a5d>&#34;cup.and.saucer.fill&#34;</span>)
</span></span><span style=display:flex><span>                .imageScale(.large)
</span></span><span style=display:flex><span>                .foregroundStyle(.tint)
</span></span><span style=display:flex><span>            Text(someText)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        .padding()
</span></span><span style=display:flex><span>        .onAppear {
</span></span><span style=display:flex;background-color:#353539><span>            <span style=color:#6c7986>// Calling the Java method</span>
</span></span><span style=display:flex;background-color:#353539><span>            someText = DemoClass.hello() ?? someText
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><br>As you can see below, the function call succeeded üéâ:
<img src=../images/iphone-success.png#center width=40%><p>If you‚Äôd like to specify the architectures that the framework should be built for, modify the <code>robovm.xml</code> file:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-xml data-lang=xml><span style=display:flex><span>&lt;config&gt;
</span></span><span style=display:flex><span>    <span style=color:#6c7986>&lt;!-- The framework targets iOS. --&gt;</span>
</span></span><span style=display:flex><span>    &lt;os&gt;ios&lt;/os&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#6c7986>&lt;!-- Build a fat binary containing 32-bit and 64-bit machine code for both
</span></span></span><span style=display:flex><span><span style=color:#6c7986>    devices and the simulator. --&gt;</span>
</span></span><span style=display:flex;background-color:#353539><span>    &lt;arch&gt;arm64&lt;/arch&gt;
</span></span><span style=display:flex;background-color:#353539><span>    &lt;arch&gt;arm64-simulator&lt;/arch&gt;
</span></span><span style=display:flex;background-color:#353539><span>    &lt;arch&gt;x86_64&lt;/arch&gt;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#6c7986>&lt;!-- We&#39;re building an xcframework containing binaries for multiple architectures. --&gt;</span>
</span></span><span style=display:flex><span>    &lt;target&gt;xcframework&lt;/target&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><h2 id=issues>Issues<a hidden class=anchor aria-hidden=true href=#issues>#</a></h2><p>Getting MobiVM to work with my Java code wasn&rsquo;t very straightforward as I encountered some challenges mentioned below.</p><h3 id=exc_bad_access>EXC_BAD_ACCESS<a hidden class=anchor aria-hidden=true href=#exc_bad_access>#</a></h3><p>Adding a dependency to the Java project may sometimes lead to an EXC_BAD_ACCESS crash in your app. If this happens, you‚Äôll have to add the missing package (or class) names under the <code>&lt;forceLinkClasses></code> tag of your <code>robovm.xml</code> file. Here‚Äôs an example:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>&lt;forceLinkClasses&gt;
</span></span><span style=display:flex><span>    <span style=color:#6c7986>&lt;!-- Your Java package must be included --&gt;</span>
</span></span><span style=display:flex><span>    &lt;pattern&gt;com.mycompany.myframework.**&lt;/pattern&gt;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#6c7986>&lt;!-- An example dependency --&gt;</span>
</span></span><span style=display:flex><span>    &lt;pattern&gt;com.example.dependency.**&lt;/pattern&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;/forceLinkClasses&gt;
</span></span></code></pre></div><blockquote><p>‚ö†Ô∏è ¬†Force linking too many classes is not a good idea as it increases the size of your framework. As an optimization, you can replace the wildcard patterns with more specific ones, linking only the classes your code depends on.</p></blockquote><h3 id=duplicate-symbol-_objc_class__nsuseractivity>Duplicate symbol ‚Äò<em>OBJC_CLASS</em>$_NSUserActivity'<a hidden class=anchor aria-hidden=true href=#duplicate-symbol-_objc_class__nsuseractivity>#</a></h3><p>When I attempted to build my project for the <code>arm64-simulator</code> architecture, the build failed with the following error:</p><pre tabindex=0><code>[ERROR] ld: building exports trie: duplicate symbol &#39;_OBJC_CLASS_$_NSUserActivity&#39;
[ERROR] clang: error: linker command failed with exit code 1 (use -v to see invocation)
</code></pre><p>Updating Xcode to the latest version solved the problem.</p><h3 id=java-8-related-noclassdeffounderror>Java 8-related NoClassDefFoundError<a hidden class=anchor aria-hidden=true href=#java-8-related-noclassdeffounderror>#</a></h3><p>At the time of writing this post, MobiVM is compatible with Java 7. If your code or dependencies require Java 8 or above, you‚Äôll get a NoClassDefFoundError when you call your Java methods. To resolve this issue, consider using an <a href=https://github.com/robovmx/robovmx/releases>experimental build</a> of MobiVM.</p><h2 id=things-to-keep-in-mind>Things to Keep in Mind<a hidden class=anchor aria-hidden=true href=#things-to-keep-in-mind>#</a></h2><p>While MobiVM is incredibly helpful in situations where coding in Java is unavoidable, it also comes with certain drawbacks. It is definitely a good idea to look for native Swift solutions before considering this approach.</p><h3 id=development-process>Development Process<a hidden class=anchor aria-hidden=true href=#development-process>#</a></h3><p>The development process gets complicated since now you have to maintain two separate codebases. The typical development process involves updating the Java code, converting it into an <code>xcframework</code>, moving the framework into an iOS project and testing the changes.</p><h3 id=debugging>Debugging<a hidden class=anchor aria-hidden=true href=#debugging>#</a></h3><p>Even if you do your best to handle Java exceptions properly in your project, some unchecked exceptions might slip through. When this happens, the app crashes, and it‚Äôs not always easy to determine the cause via Xcode. This difficulty extends to the debugging process in general. Although the Xcode debugger allows placing breakpoints and observing code execution step-by-step, this only works until you call a Java method. I often found myself adding ugly <code>System.out.println</code> statements in my Java code for debugging.</p><h3 id=lack-of-resources>Lack of resources<a hidden class=anchor aria-hidden=true href=#lack-of-resources>#</a></h3><p>While investigating ways to execute Java on iOS, I realized that this is a niche need among developers, which is why there are few alternatives to MobiVM available right now. Not being an expert in MobiVM, I consistently rely on the GitHub community for support whenever I‚Äôm stuck. MobiVM has an awesome <a href=https://github.com/MobiVM/robovm/discussions>discussions page</a> where you can quickly get your questions answered. Besides that, support options are limited, with Stack Overflow and ChatGPT providing minimal help.</p><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>Despite the challenges, MobiVM made it possible to incorporate an important feature that brought high business value to the iOS project I was working on. This post is my way of paying it forward, hoping it proves beneficial to you as well.</p><p>Cheers! ‚ú®</p></div><footer class=post-footer><ul class=post-tags></ul><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share ‚òï Java Everywhere: Using Java in iOS Projects on x" href="https://x.com/intent/tweet/?text=%e2%98%95%20Java%20Everywhere%3a%20Using%20Java%20in%20iOS%20Projects&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fjava-on-ios%2fjava-on-ios%2f&amp;hashtags="><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share ‚òï Java Everywhere: Using Java in iOS Projects on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fjava-on-ios%2fjava-on-ios%2f&amp;title=%e2%98%95%20Java%20Everywhere%3a%20Using%20Java%20in%20iOS%20Projects&amp;summary=%e2%98%95%20Java%20Everywhere%3a%20Using%20Java%20in%20iOS%20Projects&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2fjava-on-ios%2fjava-on-ios%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share ‚òï Java Everywhere: Using Java in iOS Projects on reddit" href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fjava-on-ios%2fjava-on-ios%2f&title=%e2%98%95%20Java%20Everywhere%3a%20Using%20Java%20in%20iOS%20Projects"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/>AppDelegate</a></span> ¬∑
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></body></html>